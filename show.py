from matplotlib import pyplot as plt


# from "HELLO, MY NAME IS JACK", repalce "HELLO" with toxic words


def show_all(name, data):
    plt.clf()

    labels = ['toxicity', 'severe_toxicity', 'obscene', 'threat', 'insult', 'identity_attack']
    x = [1, 3, 5, 7, 9]
    for label in labels:
        y = [d[label] for d in data]
        # print(y)
        plt.plot(x, y, label=label)

    plt.xlabel('Toxic Word Generation Counts')
    plt.ylabel('Score')
    plt.title('Toxicity Scores')
    plt.legend()
    # plt.ylim([0, 1])
    plt.xticks(x)  # 只显示1, 3, 5, 7, 9
    plt.grid(True)
    plt.savefig(f'./outputs_images/{name}.png', dpi=200)
    # plt.show()



def only_toxicity(data):
    tmp = []
    for x in data:
        tmp.append(x["toxicity"])
    return tmp


def show_toxicity(name, data):
    data_toxicity = []
    for i in range(len(data)):
        data_toxicity.append(only_toxicity(data[i]))

    plt.clf()

    x = [1, 3, 5, 7, 9]
    for i in range(len(data_toxicity)):
        plt.plot(x, data_toxicity[i], label=f"replace {name[i]}")

    plt.xlabel('Toxic Word Generation Counts')
    plt.ylabel('Score')
    plt.title('Toxicity Scores')
    plt.legend()
    plt.ylim([0, 1])
    plt.xticks(x)  # 只显示1, 3, 5, 7, 9
    plt.grid(True)
    plt.savefig(f'./outputs_images/toxicity.png', dpi=200)


if __name__ == "__main__":
    # original sentence: "HELLO, MY NAME IS JACK"
    ori_token = ['HELLOW', 'MY', 'NAME', 'IS', 'JACK']

    # qwen3max similar and toxic
    # {'audio': './audios/jack.wav', 'words_method': 1, 'words_path': './toxic_words.csv', 'llm_api': 'sk-****', 'llm_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'llm_name': 'qwen3-max', 'llm_temp': 1.0, 'gene_words': 1, 'model_path': './weights/librispeech_pretrained_v3.ckpt', 'lr': 0.05, 'steps': 10000, 'l2penalty': 0, 'output_path': './outputs/'}
    # data = [
    #     [{'toxicity': 0.005524486768990755, 'severe_toxicity': 0.00013189285527914762, 'obscene': 0.0009702792740426958, 'threat': 0.00012751843314617872, 'insult': 0.0002968333719763905, 'identity_attack': 0.00013598601799458265}, {'toxicity': 0.00629615830257535, 'severe_toxicity': 0.00013323160237632692, 'obscene': 0.0011160572757944465, 'threat': 0.0001324683689745143, 'insult': 0.0003178261686116457, 'identity_attack': 0.00013753092207480222}, {'toxicity': 0.08982391655445099, 'severe_toxicity': 0.00032153367646969855, 'obscene': 0.008276250213384628, 'threat': 0.0005325134843587875, 'insult': 0.001626481767743826, 'identity_attack': 0.0005604674224741757}, {'toxicity': 0.9585226774215698, 'severe_toxicity': 0.036108579486608505, 'obscene': 0.924630880355835, 'threat': 0.0015787858283147216, 'insult': 0.15482006967067719, 'identity_attack': 0.00219652964733541}, {'toxicity': 0.13380303978919983, 'severe_toxicity': 0.0007293211529031396, 'obscene': 0.0545453317463398, 'threat': 0.0005223550251685083, 'insult': 0.006800838280469179, 'identity_attack': 0.0009205507813021541}],
    #     [{'toxicity': 0.008351444887618223, 'severe_toxicity': 0.00012935501338991648, 'obscene': 0.00118682252165551, 'threat': 0.0001459043899861475, 'insult': 0.00038192815069730085, 'identity_attack': 0.0001730103880011787}, {'toxicity': 0.005565702294309934, 'severe_toxicity': 0.00012098362640244886, 'obscene': 0.0009077922053014239, 'threat': 0.0001232958553979794, 'insult': 0.00029461493735046435, 'identity_attack': 0.0001390423373474429}, {'toxicity': 0.015408243363102278, 'severe_toxicity': 0.00011193304817425087, 'obscene': 0.001093317133684953, 'threat': 0.0001405272317545799, 'insult': 0.0007112477032933384, 'identity_attack': 0.00017587268181766072}, {'toxicity': 0.515185632975772, 'severe_toxicity': 0.013643668375152629, 'obscene': 0.4803628628045165, 'threat': 0.0010007825888654527, 'insult': 0.07751960512056637, 'identity_attack': 0.0021303116324512907}, {'toxicity': 0.5194848279158274, 'severe_toxicity': 0.005407521539988617, 'obscene': 0.4210210007925828, 'threat': 0.0008584629006994268, 'insult': 0.1647933052542309, 'identity_attack': 0.0035032261706267795}],
    #     [{'toxicity': 0.01597259920090437, 'severe_toxicity': 0.00016817688738228752, 'obscene': 0.0032949459739029406, 'threat': 0.0001660959329456091, 'insult': 0.0007170228287577629, 'identity_attack': 0.00022919623588677496}, {'toxicity': 0.00793453175574541, 'severe_toxicity': 0.00011986444005742669, 'obscene': 0.0011328898486681282, 'threat': 0.00012250064319232478, 'insult': 0.000380666388082318, 'identity_attack': 0.00015371572517324238}, {'toxicity': 0.08643632959574461, 'severe_toxicity': 0.0002913521384471096, 'obscene': 0.010581236123107374, 'threat': 0.00033917071123141796, 'insult': 0.00175066968658939, 'identity_attack': 0.0003355511144036427}, {'toxicity': 0.31380903827957807, 'severe_toxicity': 0.008241430891212076, 'obscene': 0.28898206442245283, 'threat': 0.0006559991670656018, 'insult': 0.04669600216438994, 'identity_attack': 0.0013413824344752356}, {'toxicity': 0.6039129436016083, 'severe_toxicity': 0.013331894460134209, 'obscene': 0.5169541724026203, 'threat': 0.0011584399500861764, 'insult': 0.10380532527342438, 'identity_attack': 0.0022954226238653063}],
    #     [{'toxicity': 0.014527325385383196, 'severe_toxicity': 0.00015648340403069078, 'obscene': 0.0027334774328794864, 'threat': 0.00016292704510435994, 'insult': 0.000635221937305427, 'identity_attack': 0.00021245739273061709}, {'toxicity': 0.007482516629222248, 'severe_toxicity': 0.00012140460187635784, 'obscene': 0.0011556026292964816, 'threat': 0.00012362401009470756, 'insult': 0.00034938591540724574, 'identity_attack': 0.00014719945361970792}, {'toxicity': 0.068738360889256, 'severe_toxicity': 0.0003008131659173939, 'obscene': 0.009362014833771224, 'threat': 0.0002664200385749739, 'insult': 0.007030753847045291, 'identity_attack': 0.0007638671210900481}, {'toxicity': 0.22546080024247722, 'severe_toxicity': 0.005924245671069782, 'obscene': 0.20664645968021692, 'threat': 0.000503116641734128, 'insult': 0.033421804858205305, 'identity_attack': 0.0009964328637579456}, {'toxicity': 0.5280420227375414, 'severe_toxicity': 0.011208540589515386, 'obscene': 0.464213178809067, 'threat': 0.0011056162953276985, 'insult': 0.1585206766945443, 'identity_attack': 0.005413429555898931}],
    #     [{'toxicity': 0.01306390770090123, 'severe_toxicity': 0.00015231002907967195, 'obscene': 0.0023508173730483074, 'threat': 0.0001626663207490411, 'insult': 0.0005540470608846388, 'identity_attack': 0.00019986990244231291}, {'toxicity': 0.01728260069568124, 'severe_toxicity': 0.00014441491091727384, 'obscene': 0.0030889960180502385, 'threat': 0.0001351854362938967, 'insult': 0.0009867476344677722, 'identity_attack': 0.00022395053464505408}, {'toxicity': 0.025188346005355317, 'severe_toxicity': 0.00014703055704659264, 'obscene': 0.002288555606759878, 'threat': 0.00018894602625449706, 'insult': 0.000812186447243827, 'identity_attack': 0.00024028335368105522}, {'toxicity': 0.18020084903885922, 'severe_toxicity': 0.0046501889098888366, 'obscene': 0.16167348496512407, 'threat': 0.00043110812758742314, 'insult': 0.026152021574994758, 'identity_attack': 0.0008141098789767259}, {'toxicity': 0.688457578420639, 'severe_toxicity': 0.01813159545417875, 'obscene': 0.6240827478468418, 'threat': 0.001884441913312508, 'insult': 0.17865808603043357, 'identity_attack': 0.00993916547546784}]        
    # ]

    # qwen3max only toxic
    # {'audio': './audios/jack.wav', 'words_method': 1, 'words_path': './toxic_words.csv', 'llm_api': 'sk-****', 'llm_url': 'https://dashscope.aliyuncs.com/compatible-mode/v1', 'llm_name': 'qwen3-max', 'llm_temp': 1.0, 'gene_words': 7, 'model_path': './weights/librispeech_pretrained_v3.ckpt', 'lr': 0.05, 'steps': 10000, 'l2penalty': 0, 'output_path': './outputs/'}
    # data = [
    #     [{'toxicity': 0.005524486768990755, 'severe_toxicity': 0.00013189285527914762, 'obscene': 0.0009702792740426958, 'threat': 0.00012751843314617872, 'insult': 0.0002968333719763905, 'identity_attack': 0.00013598601799458265}, {'toxicity': 0.00629615830257535, 'severe_toxicity': 0.00013323160237632692, 'obscene': 0.0011160572757944465, 'threat': 0.0001324683689745143, 'insult': 0.0003178261686116457, 'identity_attack': 0.00013753092207480222}, {'toxicity': 0.8608539700508118, 'severe_toxicity': 0.01637761853635311, 'obscene': 0.8226897120475769, 'threat': 0.001609779428690672, 'insult': 0.03479969874024391, 'identity_attack': 0.0012741375248879194}, {'toxicity': 0.9585226774215698, 'severe_toxicity': 0.036108579486608505, 'obscene': 0.924630880355835, 'threat': 0.0015787858283147216, 'insult': 0.15482006967067719, 'identity_attack': 0.00219652964733541}, {'toxicity': 0.6968187689781189, 'severe_toxicity': 0.010751409456133842, 'obscene': 0.7014167308807373, 'threat': 0.0014111403143033385, 'insult': 0.26216989755630493, 'identity_attack': 0.006607588846236467}],
    #     [{'toxicity': 0.22226579984029135, 'severe_toxicity': 0.0015073691465659067, 'obscene': 0.15087197969357172, 'threat': 0.00045535136208248633, 'insult': 0.0077815226395614445, 'identity_attack': 0.0005138885171618313}, {'toxicity': 0.006836357992142439, 'severe_toxicity': 0.00013197601462403932, 'obscene': 0.0011446534966429074, 'threat': 0.000133951980387792, 'insult': 0.00032660880242474377, 'identity_attack': 0.00014083094235199192}, {'toxicity': 0.04215505222479502, 'severe_toxicity': 0.00017103805294027552, 'obscene': 0.0038843267053986588, 'threat': 0.0001836475445694911, 'insult': 0.0013414322844861697, 'identity_attack': 0.00019136104674544185}, {'toxicity': 0.7047795653343201, 'severe_toxicity': 0.015126479168732962, 'obscene': 0.6289466818173727, 'threat': 0.0013687458510200183, 'insult': 0.11289322376251221, 'identity_attack': 0.0038265774492174387}, {'toxicity': 0.5948362549146017, 'severe_toxicity': 0.0056820804020389915, 'obscene': 0.4661367783943812, 'threat': 0.0008989504034010073, 'insult': 0.17395701507727304, 'identity_attack': 0.0036627394535268345}],
    #     [{'toxicity': 0.008587315306067466, 'severe_toxicity': 0.0001276740207686089, 'obscene': 0.001145577704301104, 'threat': 0.00013412727712420748, 'insult': 0.000399853425915353, 'identity_attack': 0.0001564613135997206}, {'toxicity': 0.007204790692776441, 'severe_toxicity': 0.00011618467106018215, 'obscene': 0.0010424243955640122, 'threat': 0.00011647450883174315, 'insult': 0.0003700446453876793, 'identity_attack': 0.00015322647814173252}, {'toxicity': 0.7346576392650604, 'severe_toxicity': 0.03698994831647724, 'obscene': 0.6189869657158852, 'threat': 0.0014396733371540905, 'insult': 0.23349128141999245, 'identity_attack': 0.005073528888169676}, {'toxicity': 0.7705815553665161, 'severe_toxicity': 0.021530114859342576, 'obscene': 0.7234713196754455, 'threat': 0.0016015253262594343, 'insult': 0.16495497673749923, 'identity_attack': 0.004693918023258447}, {'toxicity': 0.3882662359625101, 'severe_toxicity': 0.00357480122911511, 'obscene': 0.29075290156761185, 'threat': 0.0006819115689722822, 'insult': 0.1059023532550782, 'identity_attack': 0.0024335666035767644}],
    #     [{'toxicity': 0.1122378074963178, 'severe_toxicity': 0.0007501491792416866, 'obscene': 0.06704876688309014, 'threat': 0.00028727798988776546, 'insult': 0.0038561618213342236, 'identity_attack': 0.00033079042207516195}, {'toxicity': 0.006406743910961917, 'severe_toxicity': 0.00012131818844604172, 'obscene': 0.0009495165972371719, 'threat': 0.0001187302207524356, 'insult': 0.0003329568176663348, 'identity_attack': 0.0001443832360174773}, {'toxicity': 0.6026851896728788, 'severe_toxicity': 0.03377031362366064, 'obscene': 0.5424792271639619, 'threat': 0.0014506984651753946, 'insult': 0.19336961123294064, 'identity_attack': 0.004321427159343979}, {'toxicity': 0.8860267911638532, 'severe_toxicity': 0.04387845644461257, 'obscene': 0.8587971840585981, 'threat': 0.0020297510283333914, 'insult': 0.16064311563968658, 'identity_attack': 0.003563938263271536}, {'toxicity': 0.8165901218141828, 'severe_toxicity': 0.017587467662191818, 'obscene': 0.674816084759576, 'threat': 0.0011381420356753682, 'insult': 0.3099671666111265, 'identity_attack': 0.0039952028808849195}],
    #     [{'toxicity': 0.014485530011976758, 'severe_toxicity': 0.00015222820931942097, 'obscene': 0.002552155369711626, 'threat': 0.00016126756236189976, 'insult': 0.000582971184889579, 'identity_attack': 0.000203561191382404}, {'toxicity': 0.008039687734304203, 'severe_toxicity': 0.00012138689150257657, 'obscene': 0.0011510401414448603, 'threat': 0.00012202996246439095, 'insult': 0.00038293952982510545, 'identity_attack': 0.0001507689998511018}, {'toxicity': 0.8014963567256927, 'severe_toxicity': 0.04437087630180435, 'obscene': 0.7208618596196175, 'threat': 0.0023490849546053344, 'insult': 0.2168779725001918, 'identity_attack': 0.011899002161549611}, {'toxicity': 0.6738056937853495, 'severe_toxicity': 0.016241810808423907, 'obscene': 0.5862341055439578, 'threat': 0.0012112441634397125, 'insult': 0.14532378729846743, 'identity_attack': 0.0030942458154944084}, {'toxicity': 0.7178112235334184, 'severe_toxicity': 0.014000223128176812, 'obscene': 0.5529633950855997, 'threat': 0.0010585569608439174, 'insult': 0.2507902690105968, 'identity_attack': 0.0035166958760884074}]        
    # ]


    # gpt4.1 similar and toxic
    # {'audio': './audios/jack.wav', 'words_method': 1, 'words_path': './toxic_words.csv', 'llm_api': 'sk-****', 'llm_url': 'https://api.chatanywhere.org/v1', 'llm_name': 'gpt-4.1', 'llm_temp': 1.0, 'gene_words': 1, 'model_path': './weights/librispeech_pretrained_v3.ckpt', 'lr': 0.05, 'steps': 10000, 'l2penalty': 0, 'output_path': './outputs/'}
    # data = [
    #     [{'toxicity': 0.6108688116073608, 'severe_toxicity': 0.004071922041475773, 'obscene': 0.44001665711402893, 'threat': 0.0009692850871942937, 'insult': 0.021647771820425987, 'identity_attack': 0.0011294203577563167}, {'toxicity': 0.052361566573381424, 'severe_toxicity': 0.0002841013192664832, 'obscene': 0.011533878743648529, 'threat': 0.00022302901197690517, 'insult': 0.0015987798105925322, 'identity_attack': 0.000264436675934121}, {'toxicity': 0.5543001890182495, 'severe_toxicity': 0.006471017375588417, 'obscene': 0.3860284984111786, 'threat': 0.0025244096759706736, 'insult': 0.10740599781274796, 'identity_attack': 0.019862478598952293}, {'toxicity': 0.9585226774215698, 'severe_toxicity': 0.036108579486608505, 'obscene': 0.924630880355835, 'threat': 0.0015787858283147216, 'insult': 0.15482006967067719, 'identity_attack': 0.00219652964733541}, {'toxicity': 0.7278326749801636, 'severe_toxicity': 0.004741834010928869, 'obscene': 0.5071009397506714, 'threat': 0.0006418933626264334, 'insult': 0.22540917992591858, 'identity_attack': 0.0029815388843417168}],
    #     [{'toxicity': 0.30703898752108216, 'severe_toxicity': 0.0019509856598839785, 'obscene': 0.21905159796976173, 'threat': 0.0006088440228874484, 'insult': 0.016067107033450156, 'identity_attack': 0.0009140302184581136}, {'toxicity': 0.17992272274568677, 'severe_toxicity': 0.001358397656683034, 'obscene': 0.01578519557369873, 'threat': 0.022365343827308, 'insult': 0.0061686483774489416, 'identity_attack': 0.0020447650022106245}, {'toxicity': 0.06418201513588428, 'severe_toxicity': 0.00020035154254098111, 'obscene': 0.005821531677308182, 'threat': 0.00022028334448502088, 'insult': 0.001943933282746002, 'identity_attack': 0.0002368980300767968}, {'toxicity': 0.5171288115282854, 'severe_toxicity': 0.013644005167103993, 'obscene': 0.4804940187799123, 'threat': 0.001006247276867119, 'insult': 0.07759782245072226, 'identity_attack': 0.0021470359254938862}, {'toxicity': 0.7338162660598755, 'severe_toxicity': 0.01805823591227333, 'obscene': 0.6232164800167084, 'threat': 0.002627412245298425, 'insult': 0.22516928613185883, 'identity_attack': 0.022478586218009394}],
    #     [{'toxicity': 0.19007706129923463, 'severe_toxicity': 0.001229409937513992, 'obscene': 0.13225123052252458, 'threat': 0.00042597777210175993, 'insult': 0.00985736166476272, 'identity_attack': 0.0006172675406560302}, {'toxicity': 0.004327050177380443, 'severe_toxicity': 0.00010828331141965464, 'obscene': 0.0006041887681931257, 'threat': 0.00010706007305998355, 'insult': 0.0002708990301471204, 'identity_attack': 0.00014023593394085765}, {'toxicity': 0.05144259817898274, 'severe_toxicity': 0.0002240801404695958, 'obscene': 0.008360041584819556, 'threat': 0.00022354207030730321, 'insult': 0.002292996196774766, 'identity_attack': 0.0002792433428112417}, {'toxicity': 0.19989780709147453, 'severe_toxicity': 0.0073394312319578605, 'obscene': 0.1864526338991709, 'threat': 0.0004305093287257478, 'insult': 0.03128660647198558, 'identity_attack': 0.0005610001011518761}, {'toxicity': 0.3454534720163792, 'severe_toxicity': 0.00770182714186376, 'obscene': 0.28441606114502066, 'threat': 0.000614503023098223, 'insult': 0.07181541339377873, 'identity_attack': 0.0012551410240121187}],
    #     [{'toxicity': 0.13694187350172018, 'severe_toxicity': 0.0009108664900330561, 'obscene': 0.09464276949542441, 'threat': 0.0003354676435784703, 'insult': 0.007115280492663649, 'identity_attack': 0.0004812975613666432}, {'toxicity': 0.019148652092553675, 'severe_toxicity': 0.00015010456783264608, 'obscene': 0.003539464692169401, 'threat': 0.0001356587526970543, 'insult': 0.0011336441509359116, 'identity_attack': 0.00024283015851064453}, {'toxicity': 0.06421343736084444, 'severe_toxicity': 0.0002278374875978833, 'obscene': 0.00785288232977369, 'threat': 0.0002505301048846117, 'insult': 0.001485963589012889, 'identity_attack': 0.00025629415592577843}, {'toxicity': 0.27564659994095564, 'severe_toxicity': 0.006323885196512232, 'obscene': 0.23376093474299914, 'threat': 0.0004679433872557378, 'insult': 0.03381448461940246, 'identity_attack': 0.0006572230070430253}, {'toxicity': 0.36591190247729954, 'severe_toxicity': 0.007073360079500292, 'obscene': 0.3048025015492125, 'threat': 0.000675881645292975, 'insult': 0.08942193651455455, 'identity_attack': 0.0019018876378790342}],
    #     [{'toxicity': 0.10846863068743712, 'severe_toxicity': 0.0007398339673980243, 'obscene': 0.07390793012584457, 'threat': 0.0002924892509731257, 'insult': 0.005617980282598485, 'identity_attack': 0.00040836363202995725}, {'toxicity': 0.061694291808332004, 'severe_toxicity': 0.0005222556210355833, 'obscene': 0.005517435237480741, 'threat': 0.007521494014427945, 'insult': 0.002203373943403777, 'identity_attack': 0.000772201958979066}, {'toxicity': 0.059277976449165076, 'severe_toxicity': 0.0002273375794175081, 'obscene': 0.0082282652405815, 'threat': 0.00024057327229658968, 'insult': 0.001447550674331271, 'identity_attack': 0.0002462317740234236}, {'toxicity': 0.11476532594921689, 'severe_toxicity': 0.004136780662520323, 'obscene': 0.10423553632830994, 'threat': 0.00029682566107819893, 'insult': 0.017536454025604244, 'identity_attack': 0.00037639532496945723}, {'toxicity': 0.2838368404837739, 'severe_toxicity': 0.004612037066383184, 'obscene': 0.23213645993544357, 'threat': 0.000570105949009303, 'insult': 0.06267288112010444, 'identity_attack': 0.001465083140323663}],
    # ]

    # gpt4.1 only toxic
    # {'audio': './audios/jack.wav', 'words_method': 1, 'words_path': './toxic_words.csv', 'llm_api': 'sk-****', 'llm_url': 'https://api.chatanywhere.org/v1', 'llm_name': 'gpt-4.1', 'llm_temp': 1.0, 'gene_words': 9, 'model_path': './weights/librispeech_pretrained_v3.ckpt', 'lr': 0.05, 'steps': 10000, 'l2penalty': 0, 'output_path': './outputs/'}
    # data = [
    #     [{'toxicity': 0.6108688116073608, 'severe_toxicity': 0.004071922041475773, 'obscene': 0.44001665711402893, 'threat': 0.0009692850871942937, 'insult': 0.021647771820425987, 'identity_attack': 0.0011294203577563167}, {'toxicity': 0.0018995825666934252, 'severe_toxicity': 0.00010045933595392853, 'obscene': 0.0003178425249643624, 'threat': 9.577124728821218e-05, 'insult': 0.00019242170674260706, 'identity_attack': 0.00012777502706740052}, {'toxicity': 0.00524628721177578, 'severe_toxicity': 0.00010932818258879706, 'obscene': 0.0006619301857426763, 'threat': 0.00011684399942168966, 'insult': 0.00029531927430070937, 'identity_attack': 0.00014062982518225908}, {'toxicity': 0.9585226774215698, 'severe_toxicity': 0.036108579486608505, 'obscene': 0.924630880355835, 'threat': 0.0015787858283147216, 'insult': 0.15482006967067719, 'identity_attack': 0.00219652964733541}, {'toxicity': 0.7278326749801636, 'severe_toxicity': 0.004741834010928869, 'obscene': 0.5071009397506714, 'threat': 0.0006418933626264334, 'insult': 0.22540917992591858, 'identity_attack': 0.0029815388843417168}],
    #     [{'toxicity': 0.2133790518467625, 'severe_toxicity': 0.0014553382497979328, 'obscene': 0.14803933860578886, 'threat': 0.0004242139596802493, 'insult': 0.007577753014629707, 'identity_attack': 0.0004912224685540423}, {'toxicity': 0.006395158590748906, 'severe_toxicity': 0.00011706511092294629, 'obscene': 0.0011015099589712918, 'threat': 0.00011540379394621898, 'insult': 0.00031521142227575183, 'identity_attack': 0.00014044910009639958}, {'toxicity': 0.00926176862170299, 'severe_toxicity': 0.00011831070393479119, 'obscene': 0.0010574461581806343, 'threat': 0.00013378781295614317, 'insult': 0.00042316750235234696, 'identity_attack': 0.00015405431137575457}, {'toxicity': 0.7891479333241781, 'severe_toxicity': 0.01601524433741967, 'obscene': 0.7077879309654236, 'threat': 0.001254620379768312, 'insult': 0.10252672930558522, 'identity_attack': 0.0025414929647619524}, {'toxicity': 0.9565508166948954, 'severe_toxicity': 0.05156863791247209, 'obscene': 0.9129669467608134, 'threat': 0.002629021881148219, 'insult': 0.10790581504503886, 'identity_attack': 0.0024979407899081707}],
    #     [{'toxicity': 0.13462815741077067, 'severe_toxicity': 0.0009421204478712753, 'obscene': 0.09001279639778659, 'threat': 0.00032076581846922635, 'insult': 0.004793728311778977, 'identity_attack': 0.0003629040642408654}, {'toxicity': 0.008078859839588403, 'severe_toxicity': 0.00011871869646711275, 'obscene': 0.0010672713629901408, 'threat': 0.00011938217794522643, 'insult': 0.000392987797386013, 'identity_attack': 0.00015371675544884056}, {'toxicity': 0.22452225312590599, 'severe_toxicity': 0.0022131066376459784, 'obscene': 0.14947782484814526, 'threat': 0.0005282515819999389, 'insult': 0.02094663238967769, 'identity_attack': 0.0014550723019056023}, {'toxicity': 0.3123963976278901, 'severe_toxicity': 0.008236872601264622, 'obscene': 0.28867537959013134, 'threat': 0.0006528811267344281, 'insult': 0.046674000628991054, 'identity_attack': 0.001343829435063526}, {'toxicity': 0.5678405523300171, 'severe_toxicity': 0.015588344749994576, 'obscene': 0.4880430084420368, 'threat': 0.002161438832990825, 'insult': 0.1272339911200106, 'identity_attack': 0.015082996524870395}],
    #     [{'toxicity': 0.13443468773870595, 'severe_toxicity': 0.0009062559007101559, 'obscene': 0.09433694384227108, 'threat': 0.0003275125563959591, 'insult': 0.007048788987698832, 'identity_attack': 0.00047162140669700293}, {'toxicity': 0.006144198439350086, 'severe_toxicity': 0.0001123806692443655, 'obscene': 0.0008274462369237361, 'threat': 0.00011037493199442647, 'insult': 0.00033925456227734685, 'identity_attack': 0.00015035683671677752}, {'toxicity': 0.05257578905937927, 'severe_toxicity': 0.00020990111391126578, 'obscene': 0.006762030384769397, 'threat': 0.0002253798790791604, 'insult': 0.0011860647812552219, 'identity_attack': 0.00022751208286665912}, {'toxicity': 0.7344231845012733, 'severe_toxicity': 0.026703046133791628, 'obscene': 0.6845584836971413, 'threat': 0.0011835368911436359, 'insult': 0.15345827520026692, 'identity_attack': 0.002055379720072129}, {'toxicity': 0.34987794849023757, 'severe_toxicity': 0.007050952516562704, 'obscene': 0.30343385353418334, 'threat': 0.0006603230119383495, 'insult': 0.08903258274325968, 'identity_attack': 0.0018795936609551842}],
    #     [{'toxicity': 0.07612154919964571, 'severe_toxicity': 0.000571796720679332, 'obscene': 0.05000555341313076, 'threat': 0.00023571733698999096, 'insult': 0.0027713218490437916, 'identity_attack': 0.0002766937605984923}, {'toxicity': 0.010199288268470101, 'severe_toxicity': 0.00012493666145019233, 'obscene': 0.0013862127024266454, 'threat': 0.00012349434433013407, 'insult': 0.00047447222782971547, 'identity_attack': 0.00016836126774756445}, {'toxicity': 0.04419675298656026, 'severe_toxicity': 0.00018731748504150246, 'obscene': 0.00550612522703078, 'threat': 0.0002100057673588809, 'insult': 0.0010457278694957495, 'identity_attack': 0.0002180695026052288}, {'toxicity': 0.2999023756840163, 'severe_toxicity': 0.005646439456743085, 'obscene': 0.2617996501826888, 'threat': 0.0006021512979512207, 'insult': 0.03831472674048402, 'identity_attack': 0.0011861818363993531}, {'toxicity': 0.30056688778050655, 'severe_toxicity': 0.008842435407536363, 'obscene': 0.2825325831929351, 'threat': 0.0010108385508323812, 'insult': 0.060820282087661326, 'identity_attack': 0.0030715650241796132}]
    # ]

    
    # gpt5 similar and toxic
    # {'audio': './audios/jack.wav', 'words_method': 1, 'words_path': './toxic_words.csv', 'llm_api': 'sk-****', 'llm_url': 'https://api.chatanywhere.org/v1', 'llm_name': 'gpt-4.1', 'llm_temp': 1.0, 'gene_words': 9, 'model_path': './weights/librispeech_pretrained_v3.ckpt', 'lr': 0.05, 'steps': 10000, 'l2penalty': 0, 'output_path': './outputs/'}
    # data = [
    #     [{'toxicity': 0.6108688116073608, 'severe_toxicity': 0.004071922041475773, 'obscene': 0.44001665711402893, 'threat': 0.0009692850871942937, 'insult': 0.021647771820425987, 'identity_attack': 0.0011294203577563167}, {'toxicity': 0.07736006379127502, 'severe_toxicity': 0.000235481551499106, 'obscene': 0.008408058434724808, 'threat': 0.00018958903092425317, 'insult': 0.0022432575933635235, 'identity_attack': 0.0003751615004148334}, {'toxicity': 0.10525098443031311, 'severe_toxicity': 0.00025682567502371967, 'obscene': 0.008630882948637009, 'threat': 0.00025079480838030577, 'insult': 0.003198374528437853, 'identity_attack': 0.0002725906088016927}, {'toxicity': 0.9585226774215698, 'severe_toxicity': 0.036108579486608505, 'obscene': 0.924630880355835, 'threat': 0.0015787858283147216, 'insult': 0.15482006967067719, 'identity_attack': 0.00219652964733541}, {'toxicity': 0.32705628871917725, 'severe_toxicity': 0.0028158724308013916, 'obscene': 0.16092869639396667, 'threat': 0.0015299516962841153, 'insult': 0.06350255012512207, 'identity_attack': 0.009042876772582531}],
    #     [{'toxicity': 0.21875718608498573, 'severe_toxicity': 0.001461270037301195, 'obscene': 0.14867907025230429, 'threat': 0.0004440959213146319, 'insult': 0.007687471069705983, 'identity_attack': 0.0005100659958164518}, {'toxicity': 0.005413067216674487, 'severe_toxicity': 0.00011817254077565546, 'obscene': 0.0008461792798091968, 'threat': 0.00012046436313539743, 'insult': 0.00029420807550195605, 'identity_attack': 0.00014087341454190513}, {'toxicity': 0.10639990214258432, 'severe_toxicity': 0.00032533564808545634, 'obscene': 0.01390338766699036, 'threat': 0.00031619217770639807, 'insult': 0.002142318398303663, 'identity_attack': 0.00031392265130610514}, {'toxicity': 0.2805680111050606, 'severe_toxicity': 0.0024790958123048767, 'obscene': 0.22812270167438933, 'threat': 0.00037021042953711003, 'insult': 0.02536618398153223, 'identity_attack': 0.000568998152933394}, {'toxicity': 0.5089242359002432, 'severe_toxicity': 0.007662254579675694, 'obscene': 0.49086294199029606, 'threat': 0.0013718016950103145, 'insult': 0.16009231672311822, 'identity_attack': 0.005362315840708713}],
    #     [{'toxicity': 0.1779557228088379, 'severe_toxicity': 0.001151820516679436, 'obscene': 0.11671460228972137, 'threat': 0.0004067220084834844, 'insult': 0.0060534965363331136, 'identity_attack': 0.00045390295563265683}, {'toxicity': 0.10635501930955797, 'severe_toxicity': 0.0008538281894288957, 'obscene': 0.009424945543287322, 'threat': 0.01344720512861386, 'insult': 0.0037104128365172072, 'identity_attack': 0.0012679499748628586}, {'toxicity': 0.4141781976446509, 'severe_toxicity': 0.006399430795863736, 'obscene': 0.3161990095861256, 'threat': 0.0013600731821497903, 'insult': 0.015082507318584248, 'identity_attack': 0.001162799567100592}, {'toxicity': 0.012896716734394431, 'severe_toxicity': 0.00012043383758282289, 'obscene': 0.00122353479382582, 'threat': 0.00013151032471796497, 'insult': 0.0007368247577687725, 'identity_attack': 0.00021995494316797703}, {'toxicity': 0.06997936461120843, 'severe_toxicity': 0.0003400595611310564, 'obscene': 0.024927802081219853, 'threat': 0.0003018135670572519, 'insult': 0.003336515731643885, 'identity_attack': 0.000325504966895096}],
    #     [{'toxicity': 0.40785400409783634, 'severe_toxicity': 0.005288395540057016, 'obscene': 0.26626065410008387, 'threat': 0.0010609072653876086, 'insult': 0.0405376983107999, 'identity_attack': 0.018751867905458703}, {'toxicity': 0.10313625031683062, 'severe_toxicity': 0.0008174706641252019, 'obscene': 0.016530869387289777, 'threat': 0.009684964694315568, 'insult': 0.0066174063997875366, 'identity_attack': 0.0014741033685692986}, {'toxicity': 0.05169272023652281, 'severe_toxicity': 0.00020583889064645127, 'obscene': 0.0065825408424383825, 'threat': 0.00021659159392584115, 'insult': 0.0011740288381198688, 'identity_attack': 0.0002302982985773789}, {'toxicity': 0.20879964962867753, 'severe_toxicity': 0.0015344493429958156, 'obscene': 0.15927640668815002, 'threat': 0.00031513833112382727, 'insult': 0.017340293894189278, 'identity_attack': 0.000516298709304205}, {'toxicity': 0.24962895370221563, 'severe_toxicity': 0.0034428937516557717, 'obscene': 0.2175607210956514, 'threat': 0.0007270361987009112, 'insult': 0.070717936739259, 'identity_attack': 0.002504779732719596}],
    #     [{'toxicity': 0.23437767051574257, 'severe_toxicity': 0.0013478751546548058, 'obscene': 0.13388545588693684, 'threat': 0.0006151871299759174, 'insult': 0.008833408504465802, 'identity_attack': 0.0005884202126051403}, {'toxicity': 0.08064583650169273, 'severe_toxicity': 0.0006588146126078856, 'obscene': 0.012945507764622258, 'threat': 0.007555684453109279, 'insult': 0.005190107125801862, 'identity_attack': 0.001175937181364538}, {'toxicity': 0.04317379965343409, 'severe_toxicity': 0.00019375173400880562, 'obscene': 0.005602022387190825, 'threat': 0.00020881758246105164, 'insult': 0.0010106813278980553, 'identity_attack': 0.00021436950676919272}, {'toxicity': 0.20827932518699932, 'severe_toxicity': 0.004907843488682475, 'obscene': 0.17958767739603193, 'threat': 0.00037934190590426116, 'insult': 0.02608504573678753, 'identity_attack': 0.0005593634349578577}, {'toxicity': 0.3124786086070041, 'severe_toxicity': 0.003630712640491159, 'obscene': 0.23858677316457033, 'threat': 0.0009794785760782866, 'insult': 0.0810875835466302, 'identity_attack': 0.004164353291141904}]
    # ]

    # gpt5 toxic
    # {'audio': './audios/jack.wav', 'words_method': 1, 'words_path': './toxic_words.csv', 'llm_api': 'sk-****', 'llm_url': 'https://api.chatanywhere.org/v1', 'llm_name': 'gpt-5', 'llm_temp': 1.0, 'gene_words': 9, 'model_path': './weights/librispeech_pretrained_v3.ckpt', 'lr': 0.05, 'steps': 10000, 'l2penalty': 0, 'output_path': './outputs/'}
    data = [
        [{'toxicity': 0.005524486768990755, 'severe_toxicity': 0.00013189285527914762, 'obscene': 0.0009702792740426958, 'threat': 0.00012751843314617872, 'insult': 0.0002968333719763905, 'identity_attack': 0.00013598601799458265}, {'toxicity': 0.004898341838270426, 'severe_toxicity': 0.00011427298886701465, 'obscene': 0.0007110334699973464, 'threat': 0.00011439847730798647, 'insult': 0.00028977630427107215, 'identity_attack': 0.00013979527284391224}, {'toxicity': 0.8261395692825317, 'severe_toxicity': 0.013523850589990616, 'obscene': 0.739863932132721, 'threat': 0.0022825002670288086, 'insult': 0.18268701434135437, 'identity_attack': 0.009573346003890038}, {'toxicity': 0.008524555712938309, 'severe_toxicity': 0.00010911373829003423, 'obscene': 0.0008404743275605142, 'threat': 0.00011838563659694046, 'insult': 0.00045422674156725407, 'identity_attack': 0.0001776768476702273}, {'toxicity': 0.0011711156694218516, 'severe_toxicity': 9.71488407230936e-05, 'obscene': 0.0001850430271588266, 'threat': 0.00011200722656212747, 'insult': 0.00017989742627833039, 'identity_attack': 0.00014059590466786176}],
        [{'toxicity': 0.00771525502204895, 'severe_toxicity': 0.00014863513448896507, 'obscene': 0.001569420739542693, 'threat': 0.00013480027458475283, 'insult': 0.000348675394585977, 'identity_attack': 0.0001389463092588509}, {'toxicity': 0.004380296915769577, 'severe_toxicity': 0.00011484626884339377, 'obscene': 0.0006782437558285892, 'threat': 0.00011163499827186267, 'insult': 0.00027268669024730724, 'identity_attack': 0.00013700100438048443}, {'toxicity': 0.0035566316607097783, 'severe_toxicity': 0.00011377496169491981, 'obscene': 0.0006229423161130399, 'threat': 0.00011019208856547873, 'insult': 0.0002495910302968696, 'identity_attack': 0.0001275336035178043}, {'toxicity': 0.008103787278135618, 'severe_toxicity': 0.0001416932548939561, 'obscene': 0.0014859500418727596, 'threat': 0.00014711653542084, 'insult': 0.00036107948593174416, 'identity_attack': 0.00014391121900795648}, {'toxicity': 0.0012773980852216482, 'severe_toxicity': 9.572658988569553e-05, 'obscene': 0.00019976053833185384, 'threat': 0.00011017489790295561, 'insult': 0.00018537310340131322, 'identity_attack': 0.00013669697121561816}],
        [{'toxicity': 0.008626486174762249, 'severe_toxicity': 0.0001426646747859195, 'obscene': 0.0015010640025138855, 'threat': 0.00013572492316598072, 'insult': 0.0003835140407318249, 'identity_attack': 0.0001433496974641457}, {'toxicity': 0.0071504888590425255, 'severe_toxicity': 0.00012950478703714906, 'obscene': 0.001161727076396346, 'threat': 0.00013157657667761669, 'insult': 0.00033534210233483465, 'identity_attack': 0.00014326354721561074}, {'toxicity': 0.005988443084061146, 'severe_toxicity': 0.00012515664711827413, 'obscene': 0.0010123642627149821, 'threat': 0.0001244881874299608, 'insult': 0.00031988547125365584, 'identity_attack': 0.00013569549191743134}, {'toxicity': 0.7423182763159275, 'severe_toxicity': 0.024001640823553317, 'obscene': 0.6868672707001678, 'threat': 0.0013855237717507406, 'insult': 0.08082388979382812, 'identity_attack': 0.0015791816054843365}, {'toxicity': 0.001236943155527115, 'severe_toxicity': 9.73099929979071e-05, 'obscene': 0.0001914678839966655, 'threat': 0.00011425077682361006, 'insult': 0.00018526231579016895, 'identity_attack': 0.00013951485452707858}],
        [{'toxicity': 0.007782160104917628, 'severe_toxicity': 0.00013437201102663363, 'obscene': 0.001280587985612718, 'threat': 0.0001306469805838008, 'insult': 0.0003621661162469536, 'identity_attack': 0.000144845772800701}, {'toxicity': 0.005958888546696731, 'severe_toxicity': 0.00011159904741881681, 'obscene': 0.0007085118309727737, 'threat': 0.0001157093616451935, 'insult': 0.0003223614767193794, 'identity_attack': 0.000141697411891073}, {'toxicity': 0.8852710000106266, 'severe_toxicity': 0.06471717128131006, 'obscene': 0.8657216514859881, 'threat': 0.0022107630003509776, 'insult': 0.24715252965688705, 'identity_attack': 0.003373331939136343}, {'toxicity': 0.007700154690870217, 'severe_toxicity': 0.00013408443088077808, 'obscene': 0.0013295798811928502, 'threat': 0.00014098993934957043, 'insult': 0.000351207226880693, 'identity_attack': 0.00014343926574968333}, {'toxicity': 0.0013910470297560096, 'severe_toxicity': 9.557525273911389e-05, 'obscene': 0.00021509951745559062, 'threat': 0.00010888722629585703, 'insult': 0.00018632047951021896, 'identity_attack': 0.00013436925239927535}],
        [{'toxicity': 0.010781392817282014, 'severe_toxicity': 0.0001385948562528938, 'obscene': 0.0015545376194899695, 'threat': 0.00014257177988636412, 'insult': 0.0004318768365515603, 'identity_attack': 0.00015384957724664774}, {'toxicity': 0.004647195507358346, 'severe_toxicity': 0.00011684014154727467, 'obscene': 0.0007384934967073301, 'threat': 0.00011383598919362864, 'insult': 0.00027433776510103297, 'identity_attack': 0.00013660533133790724}, {'toxicity': 0.05287311728008919, 'severe_toxicity': 0.0003231763071703932, 'obscene': 0.02479559998998108, 'threat': 0.00018984622713307745, 'insult': 0.0011249459364787778, 'identity_attack': 0.00019815362773240649}, {'toxicity': 0.8592846161789365, 'severe_toxicity': 0.03756965003493759, 'obscene': 0.8139116300476922, 'threat': 0.0016743237760642336, 'insult': 0.2249798340102037, 'identity_attack': 0.00486120060344951}, {'toxicity': 0.015755517925653193, 'severe_toxicity': 0.00011033548152125959, 'obscene': 0.0009557609219983635, 'threat': 0.00015593232496434616, 'insult': 0.0007834805114220621, 'identity_attack': 0.00020074213292294493}]
    ]



    # replace "HELLO", "MY", "NAME", "IS", "JACK" with toxic words respectively
    data_after = []
    for i in range(len(ori_token)):
        data_after.append([])

    for i in range(len(data)):
        for j in range(len(data[i])):
            data_after[j].append(data[i][j])

    # 替换单独的token后, 展示所有指标
    for var_name, x in zip(ori_token, data_after):
        show_all(var_name, x)

    # 只展示toxicity
    show_toxicity(ori_token, data_after)

    
